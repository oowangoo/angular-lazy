{"version":3,"sources":["angular-lazy.js"],"names":["ModuleListenList","appendModuleRequires","coverNgModule","createInvoke","head","isRegister","moduleProxy","nextTick","register","registerCache","requireConfig","requireModule","stateModule","angular","module","isBootstrap","modules","moduleName","indexOf","method","_i","_len","push","name","length","$isProxy","invokeQueue","normal","isFunction","Error","result","apply","arguments","requires","appendList","baseRequires","req","Array","prototype","normalModule","fn","delay","setTimeout","directive","restrict","compile","provider","$provide","$controllerProvider","$compileProvider","$filterProvider","$injector","$animateProvider","invokeLater","providerCache","providers","registerFunction","runLater","self","this","getInstanceInjector","injector","pname","cacheName","rs","enableDistinst","block","instance","invoke","factory","service","value","constant","animation","filter","controller","config","run","args","rFn","$get","$rootElement","instanceInjector","data","document","getElementsByTagName","setConfig","extend","$cacheFactory","getFilePath","getRequireList","list","isArray","isString","isObject","forEach","v","k","fileName","relativePath","baseRequire","findRequire","onError","noop","stateName","requireList","getFile","$q","fileCache","$rootScope","ScriptLoad","filePath","deferred","that","get","defer","$promise","promise","onScriptLoad","resolve","put","$apply","onScriptError","reject","remove","loadScript","url","node","bind","createNode","addEventListener","src","appendChild","createElement","type","charset","async","setAttribute","filepath","load","$fileLoad","$stateProvider","$fileLoadProvider","registerState","state","jsRequire","requirejs","call"],"mappings":"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","file":"angular-lazy.min.js","sourcesContent":["(function() {\n  var ModuleListenList, appendModuleRequires, coverNgModule, createInvoke, head, isRegister, moduleProxy, nextTick, register, registerCache, requireConfig, requireModule, stateModule;\n\n  register = angular.module('angular.lazy.register', ['ng']);\n\n  register.isBootstrap = false;\n\n  registerCache = {\n    modules: ['ng']\n  };\n\n  register.isRegister = isRegister = function(moduleName) {\n    return registerCache.modules.indexOf(moduleName) !== -1;\n  };\n\n  ModuleListenList = ['provider', 'factory', 'service', 'value', 'constant', 'animation', 'filter', 'controller', 'directive', 'config', 'run'];\n\n  moduleProxy = function(module) {\n    var method, _i, _len;\n    registerCache.modules.push(module.name);\n    for (_i = 0, _len = ModuleListenList.length; _i < _len; _i++) {\n      method = ModuleListenList[_i];\n      module[method] = createInvoke(module, method);\n    }\n    module.$isProxy = true;\n    return module;\n  };\n\n  createInvoke = function(module, method) {\n    var invokeQueue, normal;\n    normal = module[method];\n    if (!normal || !angular.isFunction(normal)) {\n      throw new Error(\"badmethod  no method \" + method + \" name\");\n    }\n    invokeQueue = function() {\n      var result;\n      result = normal.apply(module, arguments);\n      if (register.isBootstrap) {\n        register.register(module, method, arguments);\n      }\n      return result;\n    };\n    return invokeQueue;\n  };\n\n  appendModuleRequires = function(moduleName, requires) {\n    var appendList, baseRequires, module, req, _i, _len;\n    module = angular.module(moduleName);\n    baseRequires = module.requires;\n    appendList = [];\n    for (_i = 0, _len = requires.length; _i < _len; _i++) {\n      req = requires[_i];\n      if (baseRequires.indexOf(req) === -1) {\n        appendList.push(req);\n      }\n    }\n    Array.prototype.push.apply(baseRequires, appendList);\n    return module;\n  };\n\n  coverNgModule = function() {\n    var normalModule;\n    normalModule = angular.module;\n    return angular.module = function(name, requires, fn) {\n      var module;\n      if (requires && isRegister(name)) {\n        return appendModuleRequires(name, requires);\n      }\n      module = normalModule(name, requires, fn);\n      if (module.$isProxy) {\n        return module;\n      }\n      return moduleProxy(module);\n    };\n  };\n\n  nextTick = function(fn, delay) {\n    return setTimeout(fn, delay || 0);\n  };\n\n  register.directive(\"body\", [\n    function() {\n      return {\n        restrict: \"E\",\n        compile: function() {\n          return register.isBootstrap = true;\n        }\n      };\n    }\n  ]).provider(\"register\", [\n    \"$provide\", \"$controllerProvider\", \"$compileProvider\", \"$filterProvider\", \"$injector\", \"$animateProvider\", function($provide, $controllerProvider, $compileProvider, $filterProvider, $injector, $animateProvider) {\n      var invokeLater, providerCache, providers, registerFunction, runLater, self;\n      self = this;\n      providerCache = {};\n      providers = {\n        $provide: $provide,\n        $controllerProvider: $controllerProvider,\n        $compileProvider: $compileProvider,\n        $filterProvider: $filterProvider,\n        $injector: $injector,\n        $animateProvider: $animateProvider,\n        getInstanceInjector: function() {\n          return angular.injector();\n        }\n      };\n      invokeLater = function(pname, method) {\n        var provider;\n        provider = providers[pname];\n        if (!provider) {\n          throw new Error(\"badProvider unsupported provider \" + pname);\n        }\n        return function() {\n          var cacheName, name, rs;\n          name = arguments[0];\n          cacheName = \"\" + method + name;\n          if (self.enableDistinst && providerCache[cacheName]) {\n            return;\n          }\n          rs = provider[method].apply(provider, arguments);\n          providerCache[cacheName] = rs;\n        };\n      };\n      runLater = function() {\n        return function(block) {\n          var instance;\n          instance = providers.getInstanceInjector();\n          return nextTick(function() {\n            return instance.invoke(block);\n          });\n        };\n      };\n      registerFunction = {\n        provider: invokeLater('$provide', 'provider'),\n        factory: invokeLater('$provide', 'factory'),\n        service: invokeLater('$provide', 'service'),\n        value: invokeLater('$provide', 'value'),\n        constant: invokeLater('$provide', 'constant', 'unshift'),\n        animation: invokeLater('$animateProvider', 'register'),\n        filter: invokeLater('$filterProvider', 'register'),\n        controller: invokeLater('$controllerProvider', 'register'),\n        directive: invokeLater('$compileProvider', 'directive'),\n        config: invokeLater('$injector', 'invoke', 'push', \"_configBlocks\"),\n        run: runLater()\n      };\n      register.register = function(module, method, args) {\n        var rFn;\n        rFn = registerFunction[method];\n        if (!rFn) {\n          throw new Error(\"badFunctioin unsupproted register \" + method);\n        }\n        rFn.apply(this, args);\n      };\n      this.$get = [\n        '$rootElement', function($rootElement) {\n          var instanceInjector;\n          instanceInjector = null;\n          providers.getInstanceInjector = function() {\n            if (!instanceInjector) {\n              instanceInjector = $rootElement.data('$injector') || angular.injector();\n            }\n            return instanceInjector;\n          };\n          return register.register;\n        }\n      ];\n      return this;\n    }\n  ]).run(['register', function(service) {}]);\n\n  coverNgModule();\n\n  requireModule = angular.module('angular.lazy.require', ['ng']);\n\n  head = document.getElementsByTagName(\"head\")[0];\n\n  requireConfig = {};\n\n  requireModule.setConfig = function(config) {\n    if (!config) {\n      requireConfig = {};\n    } else {\n      requireConfig = angular.extend(requireConfig, config);\n    }\n    return requireModule;\n  };\n\n  requireModule.factory(\"$fileCache\", [\n    \"$cacheFactory\", function($cacheFactory) {\n      return $cacheFactory(\"fileCache\");\n    }\n  ]).provider(\"$fileLoad\", [\n    function() {\n      var getFilePath, getRequireList, provider;\n      getRequireList = function(config) {\n        var list;\n        if (angular.isArray(config)) {\n          return config;\n        }\n        list = [];\n        if (!config) {\n\n        } else if (angular.isString(config)) {\n          list.push(config);\n        } else if (angular.isObject(config)) {\n          list = [];\n          angular.forEach(config, function(v, k) {\n            return Array.prototype.push.apply(list, getRequireList(v));\n          });\n        }\n        return list;\n      };\n      getFilePath = function(fileName, relativePath) {\n        var baseRequire;\n        baseRequire = requireModule.findRequire();\n        if (relativePath) {\n          baseRequire = baseRequire[relativePath];\n        }\n        if (!baseRequire) {\n          return '';\n        }\n        return baseRequire[fileName];\n      };\n      provider = this;\n      provider.onError = angular.noop;\n      provider.setConfig = requireModule.setConfig;\n      provider.findRequire = function(stateName) {\n        var requireList;\n        requireList = requireConfig[stateName] || [];\n        requireList = getRequireList(requireList);\n        return requireList;\n      };\n      provider.getFile = function() {};\n      provider.$get = [\n        '$q', '$fileCache', '$rootScope', function($q, fileCache, $rootScope) {\n          var ScriptLoad;\n          ScriptLoad = (function() {\n            function ScriptLoad(filePath) {\n              var deferred, that;\n              if (filePath && (that = fileCache.get(filePath))) {\n                return that;\n              }\n              deferred = $q.defer();\n              this.$promise = deferred.promise;\n              this.onScriptLoad = function() {\n                deferred.resolve(123);\n                fileCache.put(filePath, true);\n                $rootScope.$apply();\n              };\n              this.onScriptError = function() {\n                deferred.reject('bad request');\n                fileCache.remove(filePath);\n                $rootScope.$apply();\n                angular.isFunction(provider.onError) && provider.onError();\n              };\n              if (!filePath) {\n                deferred.reject('empty path');\n              } else {\n                fileCache.put(filePath, this);\n                this.loadScript(filePath);\n              }\n              return this;\n            }\n\n            ScriptLoad.prototype.loadScript = function(url) {\n              var node, onScriptError, onScriptLoad;\n              onScriptError = this.onScriptError.bind(this);\n              onScriptLoad = this.onScriptLoad.bind(this);\n              node = this.createNode();\n              node.addEventListener('load', onScriptLoad);\n              node.addEventListener('error', onScriptError);\n              node.src = url;\n              return head.appendChild(node);\n            };\n\n            ScriptLoad.prototype.createNode = function() {\n              var node;\n              node = document.createElement(\"script\");\n              node.type = \"text/javascript\";\n              node.charset = 'utf-8';\n              node.async = true;\n              node.setAttribute && node.setAttribute(\"ng-lazy\", \"load\");\n              return node;\n            };\n\n            return ScriptLoad;\n\n          })();\n          return provider.getFile = function(filepath) {\n            var load;\n            load = new ScriptLoad(filepath);\n            if (load.$promise) {\n              return load.$promise;\n            } else {\n              return load;\n            }\n          };\n        }\n      ];\n      return provider;\n    }\n  ]).run([\"$fileLoad\", function($fileLoad) {}]);\n\n  stateModule = angular.module('angular.lazy.state', ['ng', 'ui.router', 'angular.lazy.require', 'angular.lazy.register']);\n\n  stateModule.config([\n    '$stateProvider', '$fileLoadProvider', function($stateProvider, $fileLoadProvider) {\n      var registerState;\n      registerState = $stateProvider.state;\n      return $stateProvider.state = function(name, config) {\n        var jsRequire, resolve;\n        if (config.requirejs) {\n          jsRequire = config.requirejs;\n        } else {\n          jsRequire = $fileLoadProvider.findRequire(name);\n        }\n        if (jsRequire && (resolve = config.resolve || {})) {\n          angular.forEach(jsRequire, function(v, k) {\n            resolve[\"loadJSFile\" + k] = function() {\n              return $fileLoadProvider.getFile(v, name);\n            };\n          });\n          config.resolve = resolve;\n        }\n        return registerState.apply(this, arguments);\n      };\n    }\n  ]);\n\n}).call(this);\n"]}